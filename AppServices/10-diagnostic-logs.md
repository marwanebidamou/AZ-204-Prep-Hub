# Enabling Diagnostic Logging for Azure App Service

Effective monitoring and diagnostics are crucial for maintaining the health and performance of your Azure App Service applications. Azure App Service provides built-in diagnostics to assist with debugging and troubleshooting. This guide outlines how to enable and configure diagnostic logging for your web apps.

## Types of Diagnostic Logs

Azure App Service offers several types of diagnostic logs:

- **Application Logging (App Logs):** Logs generated by your application code, useful for tracking events, errors, and other runtime information.

- **Web Server Logging (HTTP Logs):** Logs HTTP transactions for your app, providing insights into requests and responses.

- **Detailed Error Messages:** Captures detailed error information for failed requests, aiding in troubleshooting.

- **Failed Request Tracing:** Logs detailed information about failed requests, helping to diagnose request failures.

## Enabling Diagnostic Logs via Azure Portal

1. **Navigate to Your App Service:**
   - In the [Azure portal](https://portal.azure.com), go to your App Service instance.

2. **Access App Service Logs:**
   - In the left-hand menu under "Monitoring," select **App Service logs**.

3. **Configure Application Logging:**
   - Set **Application Logging (Filesystem)** to **On**.
   - Choose the **Log Level** (e.g., Error, Warning, Information) based on your requirements.

4. **Configure Web Server Logging:**
   - Set **Web Server Logging** to **File System**.
   - Specify the **Retention Period** (e.g., 7 days) and **Quota** (e.g., 35 MB) for the logs.

5. **Enable Detailed Error Messages and Failed Request Tracing:**
   - Toggle **Detailed Error Messages** and **Failed Request Tracing** to **On** if needed.

6. **Save Settings:**
   - Click **Save** to apply the changes.

*Note:* Enabling filesystem logging is recommended only for development and debugging purposes. For production environments, consider using Blob Storage or Azure Monitor to avoid potential performance impacts.

## Accessing Logs

### Log Streaming

For real-time monitoring, Azure App Service provides a log streaming feature:

1. **Navigate to Log Stream:**
   - In your App Service instance, select **Log stream** under the "Monitoring" section.

2. **View Logs:**
   - Once the log stream connects, you can see real-time application and web server logs as they are generated.

### Downloading Logs

To download and analyze logs:

1. **Using FTP:**
   - Access the **LogFiles** directory via FTP using the credentials provided in the **App Service logs** section.
   - Navigate to the appropriate subdirectory (e.g., `LogFiles/Application/`) to find your logs.

2. **Using Kudu Console:**
   - Navigate to `https://<your-app-name>.scm.azurewebsites.net/DebugConsole`.
   - Browse to the **LogFiles** directory to view and download logs.

*Note:* For detailed steps on accessing logs via FTP or Kudu, refer to [this guide](https://stackoverflow.com/questions/70429944/how-to-get-the-logs-from-an-azure-app-service). :contentReference[oaicite:1]{index=1}

## Configuring Diagnostic Settings for Centralized Logging

For centralized logging and monitoring, configure diagnostic settings to send logs to Azure Monitor, Storage Account, or Event Hub:

1. **Navigate to Diagnostic Settings:**
   - In your App Service instance, select **Diagnostic settings** under the "Monitoring" section.

2. **Add Diagnostic Setting:**
   - Click **Add diagnostic setting**.
   - Provide a **Name** for the setting.

3. **Select Logs and Metrics:**
   - Choose the types of logs and metrics to collect (e.g., **AppServiceAppLogs**, **AppServiceHTTPLogs**).

4. **Choose Destination:**
   - Select one or more destinations:
     - **Log Analytics Workspace**: For advanced querying and analysis.
     - **Storage Account**: For long-term storage and archival.
     - **Event Hub**: For streaming to other systems.

5. **Save Settings:**
   - Click **Save** to apply the configuration.

*Note:* For detailed guidance on configuring diagnostic settings, refer to [this article](https://techcommunity.microsoft.com/blog/appsonazureblog/enabling-appserviceapplogs--appservicehttplogs-diagnostic-settings-in-app-serv/3793845). :contentReference[oaicite:2]{index=2}

## Monitoring and Querying Logs

Once logs are configured to be sent to a Log Analytics Workspace, you can query and analyze them using Kusto Query Language (KQL):

1. **Navigate to Logs:**
   - In the Azure portal, go to your Log Analytics Workspace.
   - Select **Logs** under the "General" section.

2. **Run Queries:**
   - Use KQL to query logs. For example, to retrieve application logs:

     ```kql
     AppServiceAppLogs
     | where TimeGenerated > ago(1d)
     | order by TimeGenerated desc
     ```

   - To retrieve HTTP logs:

     ```kql
     AppServiceHTTPLogs
     | where TimeGenerated > ago(1d)
     | order by TimeGenerated desc
     ```
 
